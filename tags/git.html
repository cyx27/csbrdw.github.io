<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="1、简单了解git1.1、分布式版本控制系统（Distributed Version Control System）客户端从远程仓库中不只是提取最新版本的文件快照，而是把代码仓库完整的镜像下来，包括历史记录。如此相当于所有的客户端都是仓库的分布式节点。任何一个协同工作的机器发生故障，都可以用其他的镜像恢复，包括远程仓库。 1.2、git 文件命名规则git 的文件名是由文件内容和目录结构通过 SH">
<meta property="og:type" content="website">
<meta property="og:title" content="git">
<meta property="og:url" content="https://csbrdw.love/tags/git.html">
<meta property="og:site_name" content="csbrdw">
<meta property="og:description" content="1、简单了解git1.1、分布式版本控制系统（Distributed Version Control System）客户端从远程仓库中不只是提取最新版本的文件快照，而是把代码仓库完整的镜像下来，包括历史记录。如此相当于所有的客户端都是仓库的分布式节点。任何一个协同工作的机器发生故障，都可以用其他的镜像恢复，包括远程仓库。 1.2、git 文件命名规则git 的文件名是由文件内容和目录结构通过 SH">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-93f6365c47a1a7510c9a3861e09b9db3_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-d1523ba9ef2e0b33be72838b3fbac64b_720w.webp">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-945bb649196ecd6b701e412cd0098f42_720w.webp">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-c8125d0a2a303b086d51e2537840fcfe_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-705d6aa8776a734436a9b77b9fba1813_720w.webp">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-2aad618f1a4dee2f4a7e9d3c36a2df79_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-2b05dd96449bd7c06f58270154f2bacf_720w.webp">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-467f4be59744897664dcba1dcd828578_720w.webp">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-5aa5a0260d3655764b102948f6e9686d_720w.webp">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-93d25f79e017e7d385315128ea55e4c8_720w.webp">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-2b4cd81e1c0edce340e706ebb690edd6_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-8095e983baf014b664f4d21867add327_720w.webp">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-f2a45bcec92eda04da30cb30471c4364_720w.webp">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-b0e12efc557cabbd158dbfcff94992a2_720w.webp">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-1ef6901abd53e03bdee03ba61af1a90a_720w.webp">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-28d9a00ae164ccd08e1ba600c86d9978_720w.webp">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-c242bad4ebcef8389281b2e198fcdb69_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-0cc05ff4c78f7f9fe3ae8130b4753f43_720w.webp">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-c9a54574d7c31ff6169c15108ae2a7ae_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-50cc2dff3f766dbf9d785187de9c55eb_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-93ddb710ee6eb37fd63d6969407115cb_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-534c53e949320f4cd6d717a6527e0797_720w.webp">
<meta property="og:image" content="https://csbrdw.love/">
<meta property="og:image" content="https://csbrdw.love/">
<meta property="og:image" content="https://csbrdw.love/">
<meta property="og:image" content="https://csbrdw.love/">
<meta property="og:image" content="https://csbrdw.love/">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-1605dab30396f7caf54c2baac21887d9_720w.webp">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-1e8c21cc142e3e7071421a5f80a040d0_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-776f6bf56df2e29a4ca8cdf96f6db75f_720w.webp">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-a632c9a77abd6f8d144a81498ce220d4_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-4bd1786cf5ba86a97b320a4c84e07317_720w.webp">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-94669361f4e0615c72eeaf67de68fe45_720w.webp">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-2ade18f3507509a7646827464f986286_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-2fca7f5794864c410d005c765f99a1bb_720w.webp">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-c3fa9201ba0dd66330f4526945d64c26_720w.webp">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-184eb0a8ea60e514fb8e0abe35840fe0_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-b297f9b6ec84bd88cdfb023305f16faf_720w.webp">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-a56d5854d9c2626489acb86060bc0c71_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-4e1a98412124e20afc403b133c33fe7b_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-4420a32cfb7b2c72710239498acf64af_720w.webp">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-2504a313184c47ccaa230f1dfed8abc5_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-e9648c9fe081937b927d5306e778154f_720w.webp">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-2a5c9ee19bed455a058767a782b9187a_720w.webp">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-515312f258545b3ee935d333c92cbc51_720w.webp">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-215d80f699d053561967a57b4fb2f582_720w.webp">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-4ac95de25d740b9beee6b8370dd2156c_720w.webp">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-8ba0dad56b6e3f5e41beb39a26011872_720w.webp">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-dde9ef0d9f25cd24d054472b7edc2535_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-09b1c5a85ca8813bbde6143bc0bc5bf3_720w.webp">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-2ec75e0df516978ec4b1f938e1563ca0_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-b7ef2ecad9c1989cd9469e560f8c3687_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-a6a4f4deadc1f10d71fa4a691939aa8b_720w.webp">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-4a1c52ed30747738ce47b2d46582eb16_720w.webp">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-3aec370ca16e573ca7efd383177f0c48_720w.webp">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-897451264849f9d38c0853b5a8f1e789_720w.webp">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-4a55a285a9e433c4b81735cc892d87d2_720w.webp">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-3fef2faac0f867e0a7db264fc5b30b9a_720w.webp">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-e9db4e8113905a9783f5d36f8e2e7759_720w.webp">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-85557e96a6e209f155ef56500be25054_720w.webp">
<meta property="og:image" content="https://csbrdw.love/">
<meta property="og:image" content="https://csbrdw.love/">
<meta property="og:image" content="https://csbrdw.love/">
<meta property="og:image" content="https://csbrdw.love/">
<meta property="og:image" content="https://csbrdw.love/">
<meta property="og:image" content="https://csbrdw.love/">
<meta property="og:image" content="https://csbrdw.love/">
<meta property="og:image" content="https://csbrdw.love/">
<meta property="og:image" content="https://csbrdw.love/">
<meta property="og:image" content="https://csbrdw.love/">
<meta property="og:image" content="https://csbrdw.love/">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-7853130cdd5ed7bb0b075f6e8f1d72f1_720w.webp">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-09539f7c968e20db8afded808389315e_720w.webp">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-38c91dad4ff6daed48a8e4024e530831_720w.webp">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-7ef26163cf6262c486e3aecfd04a1498_720w.webp">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-801ede94a0df884ada825b6c50933e80_720w.webp">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-7de76fc3fd69a7259e60f50a939167a2_720w.webp">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-55fb6b3597df1353a4772a531b71a905_720w.webp">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-e8ec381fade7869b2a5984ee734bf905_720w.webp">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-9d631a462b8eb5a791820f779295592b_720w.webp">
<meta property="article:published_time" content="2023-07-03T13:38:20.000Z">
<meta property="article:modified_time" content="2023-07-03T13:46:06.199Z">
<meta property="article:author" content="csbrdw">
<meta property="article:tag" content="learning">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic4.zhimg.com/80/v2-93f6365c47a1a7510c9a3861e09b9db3_720w.webp">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>git</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
    <div class="content index py4 ">
        
          <header id="header">
  <a class="u-url u-uid" href="/">
  
    
      <img id="logo" alt class="u-logo" src="/images/logo.png" />
    
  
    <div id="title">
      <h1 class="p-name">csbrdw</h1>
    </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#" aria-label="目录"><i class="fa-solid fa-bars fa-2x"></i></a>
      </li>
      <!--
     --><li><a href="/">首页</a></li><!--
   --><!--
     --><li><a href="/about/">关于</a></li><!--
   --><!--
     --><li><a href="/search/">搜索</a></li><!--
   --><!--
     --><li><a href="/archives/">归档</a></li><!--
   --><!--
     --><li><a href="/tags/">标签</a></li><!--
   --><!--
     --><li><a target="_blank" rel="noopener" href="http://github.com/cyx27">项目</a></li><!--
   -->
    </ul>
  </div>
</header>

        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  

  <div class="content" itemprop="articleBody">
      
          <h2 id="1、简单了解git"><a href="#1、简单了解git" class="headerlink" title="1、简单了解git"></a>1、简单了解git</h2><h3 id="1-1、分布式版本控制系统（Distributed-Version-Control-System）"><a href="#1-1、分布式版本控制系统（Distributed-Version-Control-System）" class="headerlink" title="1.1、分布式版本控制系统（Distributed Version Control System）"></a>1.1、分布式版本控制系统（Distributed Version Control System）</h3><p>客户端从远程仓库中不只是提取最新版本的文件快照，而是把代码仓库完整的镜像下来，包括历史记录。如此相当于所有的客户端都是仓库的分布式节点。任何一个协同工作的机器发生故障，都可以用其他的镜像恢复，包括远程仓库。</p>
<h3 id="1-2、git-文件命名规则"><a href="#1-2、git-文件命名规则" class="headerlink" title="1.2、git 文件命名规则"></a>1.2、git 文件命名规则</h3><p>git 的文件名是由文件内容和目录结构通过 SHA-1 散列（哈希）计算出来的。所以git 数据库中保存的信息实际上都是以文件内容的哈希值来索引。如果文件内容或者目录结构变化，hash 值肯定会发生变化，因此可以使用此值来保证git 文件的完整性。（这就是为什么 rebase 的时候，commitId 会发生变化的原因）</p>
<h3 id="1-3、初始化本地git-仓库"><a href="#1-3、初始化本地git-仓库" class="headerlink" title="1.3、初始化本地git 仓库"></a>1.3、初始化本地git 仓库</h3><ul>
<li>进入本地项目目录下，执行init命令，命令执行后，在目录下会生成 .git 子目录<code>cd /code/myCode``git init</code></li>
<li>将文件加入到本地仓库<code>git add *.java``git commit -m &quot;init data&quot;</code></li>
</ul>
<h3 id="1-4、远程仓库及克隆"><a href="#1-4、远程仓库及克隆" class="headerlink" title="1.4、远程仓库及克隆"></a>1.4、远程仓库及克隆</h3><ul>
<li>克隆<code>git clone &lt;url&gt;</code> 此命令远程仓库下的每一个文件，每一个版本都将被拉取下来。如果远程仓库磁盘坏了，可以随时用本地仓库恢复远程仓库数据例：<code>git clone https://github.com/libgit2/libgit2</code></li>
<li>远程仓库简称一个git 本地仓库可以绑定多个远程仓库，每个远程仓库对应一个简称，默认简称 origin查看仓库简称：<code>git remote</code></li>
</ul>
<p><img src="https://pic4.zhimg.com/80/v2-93f6365c47a1a7510c9a3861e09b9db3_720w.webp" alt="img"></p>
<ul>
<li>新增一个远程仓库<code>git remote add &lt;name&gt; &lt;url&gt;</code></li>
<li>查看当前已绑定的远程仓库<code>git remote -v</code>当前绑定了两个远程仓库，分别简称 origin，<a href="https://link.zhihu.com/?target=http://coding.net">http://coding.net</a></li>
</ul>
<p><img src="https://pic4.zhimg.com/80/v2-d1523ba9ef2e0b33be72838b3fbac64b_720w.webp" alt="img"></p>
<ul>
<li>指定两个远程仓库，本地仓库状态就有可能出现如下情况不同远程仓库，master 分支处于不同的commit 处</li>
</ul>
<p><img src="https://pic3.zhimg.com/80/v2-945bb649196ecd6b701e412cd0098f42_720w.webp" alt="img"></p>
<ul>
<li>此时进行 push 和 pull 操作需要指定目标仓库 (简称使用)<code>git push/pull &lt;remote&gt; master</code>例：<code>git push origin master``git pull coding.net master</code>首次向新仓库推送master 分支：<code>git push -u &lt;remote&gt; master</code></li>
<li>远程仓库信息查看命令：<code>git remote show &lt;remote&gt;</code>例：<code>git remote show origin</code></li>
</ul>
<p><img src="https://pic3.zhimg.com/80/v2-c8125d0a2a303b086d51e2537840fcfe_720w.webp" alt="img"></p>
<ul>
<li>远程仓库简称重命名例：将远程仓库简称 origin 重命名为 newName<code>git remote rename origin newName</code></li>
</ul>
<h3 id="1-5、-x2F-git-目录说明"><a href="#1-5、-x2F-git-目录说明" class="headerlink" title="1.5、.&#x2F;git 目录说明"></a>1.5、.&#x2F;git 目录说明</h3><p>在一个新目录下执行 git init 命令，Git 会创建一个 .git 目录。该目录包含了几乎所有git 存储和操作的东西，如果想要备份或复制一个版本库，只需要吧这个目录拷贝到另一处即可。.&#x2F;git 目录结构如下</p>
<p><img src="https://pic4.zhimg.com/80/v2-705d6aa8776a734436a9b77b9fba1813_720w.webp" alt="img"></p>
<ul>
<li><strong>config</strong>：包含项目特有的配置选项（分支等）</li>
<li><strong>HEAD</strong>：指向当前被检出的分支</li>
<li><strong>COMMIT_EDITMSG</strong>：上次提交或准备提交的 commit msg 记录</li>
<li><strong>index</strong>：保存暂存区信息</li>
<li><strong>hooks目录</strong>：客户端或服务端的钩子脚本。</li>
<li><strong>info目录</strong>：全局性排除，那些需要排除但是不希望记录在 .gitignore 文件中的排除文件记录在这个目录下的exclude 文件中</li>
<li><strong>object目录</strong>：存储所有的数据内容</li>
<li><strong>refs目录</strong>：存储指向数据（分支、远程仓库和标签）的提交对象指针注意：git 的 gc 会将 git refs 中的文件整合保存到 .git&#x2F;packed-fefs 中，保证git 执行效率分支快速检出。如果更新了引用，git 不会更新 packed-fefs 文件，只会在 .&#x2F;git&#x2F;refs&#x2F;heads 下加一条数据。所以引用的寻找都是先找 .&#x2F;git&#x2F;refs&#x2F;heads 下的数据，当 .&#x2F;git&#x2F;refs&#x2F;heads 下找不到数据，再去 .git&#x2F;packed-fefs 中找</li>
<li><strong>packed-refs</strong>：记录分支当前在哪个 commit 节点上</li>
</ul>
<h2 id="2、git-对象"><a href="#2、git-对象" class="headerlink" title="2、git 对象"></a>2、git 对象</h2><p>git 存储的所有数据内容保存在 .&#x2F;git&#x2F;object 下，该目录下保存的文件在 git 中对应一个一个的对象，可使用 ：<code>git cat-file -t &lt;SHA-1&gt;</code> 命令查看文件对应的对象类型。</p>
<h3 id="2-1、-x2F-git-x2F-object-目录说明"><a href="#2-1、-x2F-git-x2F-object-目录说明" class="headerlink" title="2.1、.&#x2F;git&#x2F;object 目录说明"></a>2.1、.&#x2F;git&#x2F;object 目录说明</h3><ul>
<li>查看object 目录下文件信息<code>git cat-file</code> 命令可以解析 object 目录下文件的内容</li>
<li><ul>
<li>查看文件内容：<code>git cat-file -p &lt;SHA-1&gt;``&lt;SHA-1&gt;</code> ：为 objects 下目录名称和文件名称，文件名称部分前缀也可以，只要不会有文件重复</li>
</ul>
</li>
</ul>
<p><img src="https://pic2.zhimg.com/80/v2-2aad618f1a4dee2f4a7e9d3c36a2df79_720w.webp" alt="img"></p>
<ul>
<li><ul>
<li>查看文件类型：<code>git cat-file -t &lt;SHA-1&gt;</code></li>
</ul>
</li>
</ul>
<p><img src="https://pic4.zhimg.com/80/v2-2b05dd96449bd7c06f58270154f2bacf_720w.webp" alt="img"></p>
<ul>
<li>object 下目录及文件命名规则通过文件内容外加一个头部信息一起做 <code>SHA-1</code> 哈希值，以此值得前两个字符用于命名子目录，余下得 38 个字符用作文件名</li>
</ul>
<h3 id="2-2、blob-对象"><a href="#2-2、blob-对象" class="headerlink" title="2.2、blob 对象"></a>2.2、blob 对象</h3><p>一个blob 对象对应一个文件快照，保存文件具体内容</p>
<ul>
<li>例：查看blob 对象 0b3f 的文件内容</li>
</ul>
<p><img src="https://pic1.zhimg.com/80/v2-467f4be59744897664dcba1dcd828578_720w.webp" alt="img"></p>
<h3 id="2-3、tree-对象"><a href="#2-3、tree-对象" class="headerlink" title="2.3、tree 对象"></a>2.3、tree 对象</h3><p>树对象的每条记录含有一个指向数据对象或者子树对象的 SHA-1 指针</p>
<ul>
<li>例：找到 master 分支上最新的提交所指的树对象：<code>git cat-file -p master^&#123;tree&#125;</code>以下树对象指向 5 个 blob 文件，指向 5 个父级树，通过对父级树的递归查找 blob 对象，可以将该树下包含的整个项目文件都找到</li>
</ul>
<p><img src="https://pic2.zhimg.com/80/v2-5aa5a0260d3655764b102948f6e9686d_720w.webp" alt="img"></p>
<ul>
<li>例：7c19 为树对象，查看该对象内容</li>
</ul>
<p><img src="https://pic1.zhimg.com/80/v2-93d25f79e017e7d385315128ea55e4c8_720w.webp" alt="img"></p>
<h3 id="2-4、commit-对象"><a href="#2-4、commit-对象" class="headerlink" title="2.4、commit 对象"></a>2.4、commit 对象</h3><p>git 的工作实质是将被改写的文件保存为数据对象(blob)，更新暂存区，记录树对象tree，最后创建一个指向顶层树对象和父提交对象的提交对象(commit)</p>
<ul>
<li>例：1e38 为commit 对象，查看该对象内容</li>
</ul>
<p><img src="https://pic3.zhimg.com/80/v2-2b4cd81e1c0edce340e706ebb690edd6_720w.webp" alt="img"></p>
<h3 id="2-5、tag-对象"><a href="#2-5、tag-对象" class="headerlink" title="2.5、tag 对象"></a>2.5、tag 对象</h3><p>打 tag 操作生成的对象类型</p>
<ul>
<li>例</li>
</ul>
<p><img src="https://pic4.zhimg.com/80/v2-8095e983baf014b664f4d21867add327_720w.webp" alt="img"></p>
<h3 id="2-6、commit、blob、tree-的关系图解"><a href="#2-6、commit、blob、tree-的关系图解" class="headerlink" title="2.6、commit、blob、tree 的关系图解"></a>2.6、commit、blob、tree 的关系图解</h3><ul>
<li>假设首次提交包含三个改变的文件，提交后产生的文件结构如下commit 指向 tree 并记录提交者和提交时间。tree 指向三个 blob 文件，记录文件快照位置</li>
</ul>
<p><img src="https://pic1.zhimg.com/80/v2-f2a45bcec92eda04da30cb30471c4364_720w.webp" alt="img"></p>
<ul>
<li>假设对文件进行修改后再次提交commit 内容中将多一个 parent 信息，指向上个 commit 节点。</li>
</ul>
<p><img src="https://pic3.zhimg.com/80/v2-b0e12efc557cabbd158dbfcff94992a2_720w.webp" alt="img"></p>
<h2 id="3、git-的三个分区"><a href="#3、git-的三个分区" class="headerlink" title="3、git 的三个分区"></a>3、git 的三个分区</h2><h3 id="3-1-三个分区说明"><a href="#3-1-三个分区说明" class="headerlink" title="3.1 三个分区说明"></a>3.1 三个分区说明</h3><ul>
<li>工作目录（Working Directory）：我们的开发目录，只保存在项目目录下。</li>
<li>索引（Index）：暂存区域，工作目录下的文件add 后会在git 仓库中生成一个 blob 文件，当前索引指向暂存文件，这里的代码commit 后会被提交到本地仓库中</li>
<li>git 仓库：记录每次提交的快照及链式结构记录提交变更的历史</li>
<li>远程仓库：大家开发中协作的共享仓库</li>
</ul>
<p><img src="https://pic3.zhimg.com/80/v2-1ef6901abd53e03bdee03ba61af1a90a_720w.webp" alt="img"></p>
<p><em>ps：可参考以下博客有详细说明 -&gt;</em> <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/96631135">腾讯技术工程：这才是真正的Git——Git内部原理揭秘！</a></p>
<h3 id="3-2-diff-命令"><a href="#3-2-diff-命令" class="headerlink" title="3.2 diff 命令"></a>3.2 diff 命令</h3><p>使用diff 命令，可以查看各个区的的文件差异</p>
<p><img src="https://pic1.zhimg.com/80/v2-28d9a00ae164ccd08e1ba600c86d9978_720w.webp" alt="img"></p>
<p>图片来自：<a target="_blank" rel="noopener" href="https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase">https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase</a></p>
<ul>
<li><code>git diff 32942 88a2e</code></li>
<li><ul>
<li>两个commit之间的变化，执行结果如下</li>
</ul>
</li>
</ul>
<p><img src="https://pic2.zhimg.com/80/v2-c242bad4ebcef8389281b2e198fcdb69_720w.webp" alt="img"></p>
<ul>
<li><ul>
<li>使用tortoiseGit 看直观结果【Diff with previous version】</li>
</ul>
</li>
</ul>
<p><img src="https://pic4.zhimg.com/80/v2-0cc05ff4c78f7f9fe3ae8130b4753f43_720w.webp" alt="img"></p>
<ul>
<li><code>git diff --cached</code>查看 HEAD 位置到暂存(Index)位置的变化，也就是所有有执行add 操作的数据变化</li>
<li><ul>
<li>idea 中的蓝色文件改变部位标识+绿色新加文件</li>
</ul>
</li>
<li><code>git diff HEAD</code>工作区到 head 之间的文件变化</li>
<li><ul>
<li>使用tortoiseGit 看直观结果【Diff】</li>
</ul>
</li>
<li><code>git diff stable</code>工作区到 stable 分支的变化</li>
<li><code>git diff</code>工作区未 commit 的工作</li>
</ul>
<h2 id="4、git-分支"><a href="#4、git-分支" class="headerlink" title="4、git 分支"></a>4、git 分支</h2><p>git 分支的本质就是一个指向commit 的指针，或者说一个指向某一系列commit 之首的指针或引用。</p>
<h3 id="4-1、分支说明"><a href="#4-1、分支说明" class="headerlink" title="4.1、分支说明"></a>4.1、分支说明</h3><ul>
<li>分支git 分支信息保存在 <code>./git/refs</code> 文件夹下文件夹下的文件以分支名命名，打开文件可以直接看到commitId</li>
</ul>
<p><img src="https://pic3.zhimg.com/80/v2-c9a54574d7c31ff6169c15108ae2a7ae_720w.webp" alt="img"></p>
<ul>
<li>HEAD 指针<code>./git/HEAD 文件</code>HEAD 作用是记录当前工作区指向的commit，一般情况下 HEAD 指向一个分支，然后通过分支找到对应指向的 commit，如下HEAD 文件内容：代表当前工作区指向 develop 分支</li>
</ul>
<p><img src="https://pic4.zhimg.com/80/v2-50cc2dff3f766dbf9d785187de9c55eb_720w.webp" alt="img"></p>
<ul>
<li>标签（tag）tag 就像是给 commit 加一个不一样的别名，让这个 commit 变成一个里程碑节点。git 存在两种标签：轻量标签（lightweight）；附注标签（annotated）</li>
<li><ul>
<li>tag 对象内容见 2.5</li>
<li>查看所有标签git tag</li>
<li>对过去的提交打标签找到需要打标签的commitId，执行如下命令<code>git tag -a &lt;tagName&gt; &lt;commitId&gt;</code></li>
<li>push 标签push tagName 标签：<code>git push origin &lt;tagName&gt;</code>push 所有标签：<code>git push origin --tags</code></li>
<li>delete 标签删除远程标签：<code>git push origin --delete &lt;tagName&gt;</code>删除本地标签：<code>git tag -d &lt;tagName&gt;</code></li>
<li>检出标签代码<code>git checkout tagName</code>注意：该命令后仓库属于分支分离状态</li>
<li>轻量标签<code>git tag tagName</code>创建轻量标签，不需要使用 -a -s -m 选项，只需要提供标签名字</li>
<li>附注标签附注标签再git 数据库中存在一个完整的对象，其包含打标签者的名字、电子邮件、日期时间等信息</li>
<li><ul>
<li>创建命令:<code>git tag -a tagName -m &quot;tag comment&quot;</code></li>
<li>查看标签内容，附注标签包含的内容比较丰富:<code>git show tagName</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="https://pic4.zhimg.com/80/v2-93ddb710ee6eb37fd63d6969407115cb_720w.webp" alt="img"></p>
<ul>
<li>远程引用分支我们看到的 origin&#x2F;x.x.xx 都是远程引用分支。远程引用分支不能通过 commit 命令来更新，它为只读状态。Git 将这些远程引用作为记录远程服务器上各分支最后已知位置状态的书签来管理。</li>
</ul>
<h3 id="4-2-分支管理"><a href="#4-2-分支管理" class="headerlink" title="4.2 分支管理"></a>4.2 分支管理</h3><ul>
<li>查看所有分支<code>git branch</code></li>
<li>查看每一个分支的最后一次提交<code>git branch -v</code></li>
<li>查看哪些分支合并到当前分支<code>git branch --merged``git branch --merged &lt;branchName&gt;</code></li>
<li>查看哪些分支没有合并到当前分支<code>git branch --no-merged``git branch --no-merged &lt;branchName&gt;</code></li>
<li>创建分支</li>
<li><ul>
<li>在当前 HEAD 指向的commit 下创建一个新的分支<code>git branch &lt;branchName&gt;</code>创建新分支，并切到新分支<code>git checkout -b &lt;branchName&gt;</code></li>
</ul>
</li>
</ul>
<p><img src="https://pic4.zhimg.com/80/v2-534c53e949320f4cd6d717a6527e0797_720w.webp" alt="img"></p>
<ul>
<li>切分支：切到 master 分支<code>git checkout master</code></li>
<li>删除分支<code>git branch -d &lt;branchName&gt;</code></li>
<li>从指定 commit 出新建一个分支<code>git branch &lt;branchName&gt; &lt;commitId&gt;</code></li>
</ul>
<h3 id="4-3-跟踪分支（本地分支跟踪远程分支）"><a href="#4-3-跟踪分支（本地分支跟踪远程分支）" class="headerlink" title="4.3 跟踪分支（本地分支跟踪远程分支）"></a>4.3 跟踪分支（本地分支跟踪远程分支）</h3><p>将远程仓库中的分支拉取下来，本地会出现一个不可编辑的分支，类似 origin&#x2F;feature1.1.0，该分支其实就是对远程仓库分支当前情况的一个标记。</p>
<ul>
<li>创建一个本地分支跟踪远程分支<code>git chechout -b &lt;localBranchName&gt; &lt;remote&gt;/&lt;remoteBranchName&gt;</code></li>
<li>使用已有的本地分支跟踪远程分支<code>git branch -u &lt;remote&gt;/&lt;remoteBranchName&gt;</code></li>
<li>删除远程分支<code>git push origin --delete feature/1.0.0</code></li>
<li>clone 命令自动产生的 master 跟踪分支当使用 clone 命令克隆一个远程项目到本地，将会在本地产生一个 master 分支跟踪远程的 origin&#x2F;master 分支</li>
<li>查看设置的跟踪分支及其相关信息<code>git branch -vv</code></li>
</ul>
<p><img src="/" alt="img"></p>
<p>iss53 跟踪 origin&#x2F;iss53，【ahead 2】 代表本地有两个提交没有推送到服务器上master 分支正在跟踪 origin&#x2F;master 分支serverfix 分支正在跟踪 teamone 服务器上的 server-fix-good 分支，服务器上有一次提交还没有合并到本地同时本地有三次提交还没有推送到 teamone&#x2F;server-fix-good 分支testing 分支并没有跟踪任何远程分支<strong>注意：</strong>这些命令来自于本地分析，也就是本地仓库上已经拉取下来的的远程分支数据和本地分支数据进行比较。如果使用 pull 命令拉取数据，远程分支的数据会自动合并到本地分支(pull 类似 fetch+merge 或 fetch+rebase)，也就是说一般不会出现 behind 的情况，除非在分析前执行远程数据拉取，但不合并到本地分，如下：<code>git fetch --all</code></p>
<h3 id="4-4-commit-命令"><a href="#4-4-commit-命令" class="headerlink" title="4.4 commit 命令"></a>4.4 commit 命令</h3><p>命令：<code>git commit</code></p>
<ul>
<li>当前用户在main 分支下，在main 分支中执行commit 操作，创建一个新的commit 节点，新 commit 指向旧的commit 节点，分支和 HEAD 指向新的commit。</li>
</ul>
<p><img src="/" alt="img"></p>
<p>图片来源：<a target="_blank" rel="noopener" href="https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase">https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase</a></p>
<ul>
<li>如果用户在 stable 上分支上 commit，将产生如下效果</li>
</ul>
<p><img src="/" alt="img"></p>
<p>图片来源：<a target="_blank" rel="noopener" href="https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase">https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase</a></p>
<ul>
<li>创建一个新的 commit，将当前commit 取消，新的commit 替代（备注错误或追加代码时可用）命令：<code>git commit --amend -m &#39;comment&#39;</code><strong>注意</strong>：旧的commit 在 objects 中依然可以找到，但是没有任何指针指向该commit。后续git gc 时会将该commit 回收</li>
</ul>
<p><img src="/" alt="img"></p>
<p>图片来源：<a target="_blank" rel="noopener" href="https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase">https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase</a></p>
<p>idea 中commit 的时候勾上 Amend commit，实现以上命令效果</p>
<p><img src="/" alt="img"></p>
<h3 id="4-5-checkout-命令"><a href="#4-5-checkout-命令" class="headerlink" title="4.5 checkout 命令"></a>4.5 checkout 命令</h3><ul>
<li>如果工作区存在工作未commit 的工作，且工作内容和切换的目标分支有冲突，切换命令会执行失败</li>
</ul>
<p><img src="https://pic2.zhimg.com/80/v2-1605dab30396f7caf54c2baac21887d9_720w.webp" alt="img"></p>
<ul>
<li>切换失败可选两种处理方式</li>
<li><ul>
<li>force checkout丢弃当前工作区所有工作，切换到目标分支</li>
<li>smart Checkout先将当前工作区工作暂存，切换到分支后 push 出来，解决冲突，合并内容</li>
</ul>
</li>
<li>切换到指定 commit命令：<code>git checkout &lt;commitId&gt;</code></li>
</ul>
<p><img src="https://pic1.zhimg.com/80/v2-1e8c21cc142e3e7071421a5f80a040d0_720w.webp" alt="img"></p>
<p>切换时出现以上提醒，表示此时出现了head 分离的现象，也就是 HEAD 没有停留在任何分支上</p>
<p><img src="https://pic4.zhimg.com/80/v2-776f6bf56df2e29a4ca8cdf96f6db75f_720w.webp" alt="img"></p>
<p>图片来源：<a target="_blank" rel="noopener" href="https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase">https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase</a></p>
<p>如果此时进行了一次 commit，产生 2eecb</p>
<p><img src="https://pic1.zhimg.com/80/v2-a632c9a77abd6f8d144a81498ce220d4_720w.webp" alt="img"></p>
<p>图片来源：<a target="_blank" rel="noopener" href="https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase">https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase</a></p>
<p>将 HEAD 切换回main 分支后，2eecb commit 将没有任何指针引用，后续会丢失。</p>
<p><img src="https://pic4.zhimg.com/80/v2-4bd1786cf5ba86a97b320a4c84e07317_720w.webp" alt="img"></p>
<p>图片来源：<a target="_blank" rel="noopener" href="https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase">https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase</a></p>
<p>如果想保留 2eecb commit，需要在切换分支之前，在 2eecb commit 上创建一个新的分支指向它命令：<code>git checkout -b &lt;branchName&gt;</code></p>
<p><img src="https://pic2.zhimg.com/80/v2-94669361f4e0615c72eeaf67de68fe45_720w.webp" alt="img"></p>
<p>图片来源：<a target="_blank" rel="noopener" href="https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase">https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase</a></p>
<h3 id="4-6-reset-命令"><a href="#4-6-reset-命令" class="headerlink" title="4.6 reset 命令"></a>4.6 reset 命令</h3><p><img src="https://pic3.zhimg.com/80/v2-2ade18f3507509a7646827464f986286_720w.webp" alt="img"></p>
<p>图片来源：<a target="_blank" rel="noopener" href="https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase">https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase</a></p>
<ul>
<li><code>git reset [commitId] --soft</code>当使用 –soft 参数 reset 到 b325c 下，b325c 之后 commit 的内容(c10b9、da985、ed489)全部会留在工作区属于add 状态。分支 和 HEAD 都指向 b325c。</li>
<li><ul>
<li>相当于 tortoiseGit -&gt; show log 的 reset .. to this commit</li>
</ul>
</li>
<li><code>git reset [commitId] --hard</code>当使用 –hard reset 到 b325c 下，b325c 之后的提交将会全部消失，也不会停留在工作区。</li>
<li>***注意***：如果线上的 main 分支处于 ed489 的位置，以上两个命令执行后在进行新的commit，本地仓库会在 commit1 上产生一个子节点commitA。push 时候会让你跟远程 main 分支合并，此时如果确认 b325c 分支之后的commit 可以舍弃，使用 force push 强制推送，覆盖线上提交记录</li>
</ul>
<h3 id="4-7-merge-命令"><a href="#4-7-merge-命令" class="headerlink" title="4.7 merge 命令"></a>4.7 merge 命令</h3><p>执行 merge 命令时有两种情况：简单的移动指针(fast-forward)；三方合并</p>
<ul>
<li>三方合并在 main 分支下执行 <code>git merge other</code>生成一个新的 commit f8bc5，该commit 指向两个父节点（33104、f8bc5）。HEAD 和分支指针移动到新的 commit</li>
</ul>
<p><img src="https://pic4.zhimg.com/80/v2-2fca7f5794864c410d005c765f99a1bb_720w.webp" alt="img"></p>
<p>图片来源：<a target="_blank" rel="noopener" href="https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase">https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase</a></p>
<ul>
<li>简单的移动指针(fast-forward)如果 main 分支是 stable分支的祖父节点，stable 上执行 git merge main命令只是简单的移动 stable 分支指针到main 分支的端点。称为 fast-forward 合并</li>
</ul>
<p><img src="https://pic3.zhimg.com/80/v2-c3fa9201ba0dd66330f4526945d64c26_720w.webp" alt="img"></p>
<p>图片来源：<a target="_blank" rel="noopener" href="https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase">https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase</a></p>
<h3 id="4-8-cherry-pick-命令"><a href="#4-8-cherry-pick-命令" class="headerlink" title="4.8 cherry pick 命令"></a>4.8 cherry pick 命令</h3><p>命令：git cherry-pick <commitId></p>
<p><img src="https://pic1.zhimg.com/80/v2-184eb0a8ea60e514fb8e0abe35840fe0_720w.webp" alt="img"></p>
<p>图片来源：<a target="_blank" rel="noopener" href="https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase">https://marklodato.github.io/visual-git-guide/index-zh-cn.html#rebase</a></p>
<ul>
<li>cherry-pick 命令是 “复制” 一个提交节点并在当前分支做一次完全一样的新的提交注意：如果 cherry-pick 的commit 2c33a 对169a6 commit 没有依赖，则 169a6 的修改不会被携带过来。如果存在依赖关系修改会被携带并需要解决冲突。</li>
<li>idea 操作 cherry-pick切到需要合并的分支，找到 cherry-pick 的commit，执行 cherry-pick</li>
</ul>
<p><img src="https://pic4.zhimg.com/80/v2-b297f9b6ec84bd88cdfb023305f16faf_720w.webp" alt="img"></p>
<h3 id="4-9-rebase-命令"><a href="#4-9-rebase-命令" class="headerlink" title="4.9 rebase 命令"></a>4.9 rebase 命令</h3><ul>
<li><strong>两个分支的简单rebase 操作</strong>分支情况：在develop分支的 C2 commit上新建分支 feature&#x2F;1.1.0，并在分支上提交了 C3 C4。有其他人在 develop分支上提交了 C5</li>
</ul>
<p><img src="https://pic2.zhimg.com/80/v2-a56d5854d9c2626489acb86060bc0c71_720w.webp" alt="img"></p>
<p>将分支切到 feature&#x2F;1.1.0，执行<code>git rebase develop</code></p>
<p><img src="https://pic4.zhimg.com/80/v2-4e1a98412124e20afc403b133c33fe7b_720w.webp" alt="img"></p>
<p>将分支切到 develop，执行 <code>git merge feature/1.1.0</code> 。此时 develop 进行fast forward，直接将指针移动到 C4&#96;</p>
<p><img src="https://pic4.zhimg.com/80/v2-4420a32cfb7b2c72710239498acf64af_720w.webp" alt="img"></p>
<ul>
<li><strong>三个分支的 rebase 操作</strong>当前分支状况如下：master 分支C2 commit 下拉出 server 分支并提交 C3 C4 C5，server 分支C3 commit 下拉出 client 分支并提交C8 C9。master 在 C2 后提交了 C5 C6。分支情况及idea log 树如下：</li>
</ul>
<p><img src="https://pic2.zhimg.com/80/v2-2504a313184c47ccaa230f1dfed8abc5_720w.webp" alt="img"></p>
<p>分支情况</p>
<p><img src="https://pic4.zhimg.com/80/v2-e9648c9fe081937b927d5306e778154f_720w.webp" alt="img"></p>
<p>idea log 树</p>
<p>希望将 client 的 C8 C9 分支合并到 develop 分支，但是 server 的 C3 分支不合并：执行命令<code>git rebase --onto develop server client</code></p>
<p><img src="https://pic3.zhimg.com/80/v2-2a5c9ee19bed455a058767a782b9187a_720w.webp" alt="img"></p>
<p>分支情况</p>
<p><img src="https://pic2.zhimg.com/80/v2-515312f258545b3ee935d333c92cbc51_720w.webp" alt="img"></p>
<p>idea log 树</p>
<p>将client 合并到 develop：将分支切到 develop，执行<code>git merge client</code></p>
<p><img src="https://pic3.zhimg.com/80/v2-215d80f699d053561967a57b4fb2f582_720w.webp" alt="img"></p>
<p><img src="https://pic1.zhimg.com/80/v2-4ac95de25d740b9beee6b8370dd2156c_720w.webp" alt="img"></p>
<p>develop 合并server 分支，并删除 client 分支和 server 分支</p>
<p><img src="https://pic3.zhimg.com/80/v2-8ba0dad56b6e3f5e41beb39a26011872_720w.webp" alt="img"></p>
<p><img src="https://pic2.zhimg.com/80/v2-dde9ef0d9f25cd24d054472b7edc2535_720w.webp" alt="img"></p>
<ul>
<li><strong>什么情况下不适合用 rebase</strong>当你的代码已经提交到线上仓库，且你的代码已经被别人拉取合并了，千万不要进行 rebase，不然会出现如下混乱情况假设你仓库情况如下：远程master 分支指向 C1，本地 master 分支有两个提交 C2 和 C3</li>
</ul>
<p><strong><img src="https://pic4.zhimg.com/80/v2-09b1c5a85ca8813bbde6143bc0bc5bf3_720w.webp" alt="img"></strong></p>
<p>A同事在远程仓库上提交了 C5，B同事在远程仓库上提交了 C4 并合并了C5 产生了 C6 commit。远程仓库当前情况如下</p>
<p><strong><img src="https://pic1.zhimg.com/80/v2-2ec75e0df516978ec4b1f938e1563ca0_720w.webp" alt="img"></strong></p>
<p>此时你拉取远程仓库 master 分支到本地并进行一次合并，产生 C7 commit，你的本地仓库情况如下</p>
<p><strong><img src="https://pic4.zhimg.com/80/v2-b7ef2ecad9c1989cd9469e560f8c3687_720w.webp" alt="img"></strong></p>
<p>这时候B 同事决定不使用 merge，改用rebase，于是他把 C4 提交和 C6 合并回滚了，并rebase 了 C4，此时远程仓库变成了如下</p>
<p><img src="https://pic4.zhimg.com/80/v2-a6a4f4deadc1f10d71fa4a691939aa8b_720w.webp" alt="img"></p>
<p>此时你再次拉取远程仓库的数据，并进行了一次合并产生了C8 commit，你的本地仓库情况如下</p>
<p><img src="https://pic3.zhimg.com/80/v2-4a1c52ed30747738ce47b2d46582eb16_720w.webp" alt="img"></p>
<p>当你把你的本地仓库push 到远程仓库上，C4和C6 又回去了，并且C4 和 C4&#96; 的提交内容及提交者一样。惊喜不惊喜！！！！</p>
<ul>
<li><strong>rebase 和 merge 的区别</strong>当前情况：feature-1.1.0 从 dev 的 tt commit 中拉取，并由A 进行了 C2, C3 提交，B 在A 提交后拉取了feature-1.1.0 分支。</li>
</ul>
<p><img src="https://pic1.zhimg.com/80/v2-3aec370ca16e573ca7efd383177f0c48_720w.webp" alt="img"></p>
<p>线上异常，打了个补丁，dev 上加了一个 C1 提交</p>
<p><img src="https://pic2.zhimg.com/80/v2-897451264849f9d38c0853b5a8f1e789_720w.webp" alt="img"></p>
<p>A 在 feature-1.1.0 分支 rebase C1，并forcePush 到线上 feature-1.1.0 分支</p>
<p><img src="https://pic3.zhimg.com/80/v2-4a55a285a9e433c4b81735cc892d87d2_720w.webp" alt="img"></p>
<p>B 在原本状态下进行开发后本地提交了 C4</p>
<p><img src="https://pic3.zhimg.com/80/v2-3fef2faac0f867e0a7db264fc5b30b9a_720w.webp" alt="img"></p>
<p>此时B 进行拉取线上 feature-1.1.0 分支</p>
<p><img src="https://pic2.zhimg.com/80/v2-e9db4e8113905a9783f5d36f8e2e7759_720w.webp" alt="img"></p>
<p><img src="https://pic1.zhimg.com/80/v2-85557e96a6e209f155ef56500be25054_720w.webp" alt="img"></p>
<p>idea log 图，出现重复的 C2 和 C3</p>
<p><img src="/" alt="img"></p>
<p><img src="/" alt="img"></p>
<p>idea log 图，C2 和 C3 只出现一次</p>
<p><em>为什么此时的rebase 操作 C2<code>=C2，C3</code>&#x3D;C3 呢？</em>Git 除了对整个提交计算 SHA-1 校验和以外，也对本次提交所引入的修改进行计算——即 patch-id。所以不会再对 C2 和 C3 进行 rebase。当然，如果A 在进行 rebase 之前将 C2<code>和 C3</code> 的内容改变了，那就C2 和 C3 只能进行再次rebase</p>
<p>4.10 fatch 和 pull 命令</p>
<h2 id="5、常见的误操作回滚"><a href="#5、常见的误操作回滚" class="headerlink" title="5、常见的误操作回滚"></a>5、常见的误操作回滚</h2><h3 id="5-1-回滚-commit-操作"><a href="#5-1-回滚-commit-操作" class="headerlink" title="5.1 回滚 commit 操作"></a>5.1 回滚 commit 操作</h3><p>见 4.6 reset 命令</p>
<h3 id="5-2-reset-–hard-误操作回滚"><a href="#5-2-reset-–hard-误操作回滚" class="headerlink" title="5.2 reset –hard 误操作回滚"></a>5.2 reset –hard 误操作回滚</h3><ul>
<li><strong>前情提要</strong>使用<code>git log --pretty=oneline</code> 查看当前 dev 分支情况下如下</li>
</ul>
<p><img src="/" alt="img"></p>
<p>将其 reset 到 C3 提交<code>git reset --hard &lt;SHA-1&gt;</code></p>
<p><img src="/" alt="img"></p>
<p>再使用 <code>git log --pretty=oneline</code> 查看当前 dev 分支情况，C4、tt、C1 都消失了</p>
<p><img src="/" alt="img"></p>
<p>注意：因为dev 分支的reset操作没有push 到远程仓库，所以 origin&#x2F;dev 还是指向 C1，如果要让 origin&#x2F;dev 也指向C3，需要在 dev 分支上执行 force push</p>
<p><img src="/" alt="img"></p>
<p>此时你发现自己 reset 错了，怎么找回 C4、tt、C1 呢？</p>
<ul>
<li><strong>方法一：回滚 reflog 的 HEAD 撤销上次reset 操作</strong>git reflog 命令可以记录本地操作的所有日志，如下</li>
</ul>
<p><img src="/" alt="img"></p>
<p>可以看到我们的 reset 操作在 HEAD@{0} 处，这时候我们可以选择回滚 HEAD@{0} 操作，执行命令：<code>git reset --hard HEAD@&#123;1&#125;</code>将操作回滚到 HEAD@{1}</p>
<p><img src="/" alt="img"></p>
<p>回滚后再使用 <code>git log --pretty=oneline</code>查看当前 dev 分支情况，发现 C4、tt、C1 都回来了</p>
<p><img src="/" alt="img"></p>
<p>此时 <code>git reflog</code>可以看到多了一个执行记录，当然这个记录可能会让人看的有点懵</p>
<p><img src="/" alt="img"></p>
<ul>
<li><strong>方法二：找到被 hard reset 掉的commit，从该commit 上再拉取一个分支</strong>使用 <code>git log -g</code>可以找到C1 的commitId</li>
</ul>
<p><img src="/" alt="img"></p>
<p>从 C1 的commitId 拉取一个分支出来</p>
<p><img src="https://pic2.zhimg.com/80/v2-7853130cdd5ed7bb0b075f6e8f1d72f1_720w.webp" alt="img"></p>
<p>切分支到新拉取的 backup-branch 分支：<code>git checkout backup-branch</code></p>
<p><img src="https://pic3.zhimg.com/80/v2-09539f7c968e20db8afded808389315e_720w.webp" alt="img"></p>
<p>使用 <code>git log --pretty=oneline</code>查看当前 backup-branch 分支情况，与一开始的 dev 分支一致，C4、tt、C1 都回来了。并且可以看到当前分支 dev 指向 C3</p>
<p><img src="https://pic2.zhimg.com/80/v2-38c91dad4ff6daed48a8e4024e530831_720w.webp" alt="img"></p>
<h2 id="6、使用git-进行协作"><a href="#6、使用git-进行协作" class="headerlink" title="6、使用git 进行协作"></a>6、使用git 进行协作</h2><h3 id="6-1、集中式工作流-也叫单点协作模型（小团队开发最常用的模式）"><a href="#6-1、集中式工作流-也叫单点协作模型（小团队开发最常用的模式）" class="headerlink" title="6.1、集中式工作流 也叫单点协作模型（小团队开发最常用的模式）"></a>6.1、集中式工作流 也叫单点协作模型（小团队开发最常用的模式）</h3><p>一个中央仓库统一管理代码代码，所有人将自己的工作同步到中央仓库，也可从中央仓库拉取代码。当开发者操作将代码push 到中央仓库时，如果无法进行 fast-forward，需要先拉取中央仓库的代码合并到本地，合并完成后，再执行push</p>
<p><img src="https://pic1.zhimg.com/80/v2-7ef26163cf6262c486e3aecfd04a1498_720w.webp" alt="img"></p>
<h3 id="6-2、集成管理者工作流-也叫多仓库工作流（开源项目最常用的模式）"><a href="#6-2、集成管理者工作流-也叫多仓库工作流（开源项目最常用的模式）" class="headerlink" title="6.2、集成管理者工作流 也叫多仓库工作流（开源项目最常用的模式）"></a>6.2、集成管理者工作流 也叫多仓库工作流（开源项目最常用的模式）</h3><p>开源项目一般有一个“官方”的权威仓库，这个仓库中的代码绝对是稳定版本，这种仓库存在权威的项目维护者，只有该维护者才有权力将代码合并到权威仓库。那么，如果有其他人想要贡献代码到该仓库中该如何操作呢？</p>
<ul>
<li><strong>仓库命名</strong>blessed repository：权威仓库integration manager：项目维护者developer public：贡献者公共仓库developer private：贡献则私有仓库</li>
<li><strong>权限仓库管理流程</strong></li>
<li><ul>
<li>项目维护者将项目推送到权威仓库</li>
<li>项目贡献者克隆此仓库并贡献代码，对项目做出修改</li>
<li>项目贡献者将修改后的数据推送到自己的公开仓库</li>
<li>项目贡献者发邮件给项目维护者，请求拉取自己的更新</li>
<li>项目维护者在自己的本地仓库中将贡献者的公共仓库加为远程仓库，并合修改并校验</li>
<li>项目维护者将合并后的修改推送动权威仓库，贡献者代码生效</li>
</ul>
</li>
</ul>
<p><img src="https://pic1.zhimg.com/80/v2-801ede94a0df884ada825b6c50933e80_720w.webp" alt="img"></p>
<h3 id="6-3、主管与副主管工作流"><a href="#6-3、主管与副主管工作流" class="headerlink" title="6.3、主管与副主管工作流"></a>6.3、主管与副主管工作流</h3><p>这种方式是多仓库工作流的变种，一般拥有数百位协作开发者的超大型项目才会用到这种工作方式，如 Linux 内核开发。</p>
<ul>
<li>具体协作流程</li>
<li><ul>
<li>blessed repository 为最终仓库，该仓库的代码只能由主管(dictator) 进行推送，其他人只读</li>
<li>普通开发者拉取 blessed repository 仓库中的代码进行开发，并根据 blessed repository 的 master 分支进行 rebase</li>
<li>副主管(lieutenant) 将普通开发者的代码合并到自己的 master 分支，并根据 blessed repository 的 master 分支进行 rebase</li>
<li>最后主管(dictator) 集成副主管的 master 分支代码，并推送到 blessed repository 仓库中</li>
</ul>
</li>
</ul>
<p><img src="https://pic3.zhimg.com/80/v2-7de76fc3fd69a7259e60f50a939167a2_720w.webp" alt="img"></p>
<h3 id="6-4、简单项目开发和发布的分支管理及流程"><a href="#6-4、简单项目开发和发布的分支管理及流程" class="headerlink" title="6.4、简单项目开发和发布的分支管理及流程"></a>6.4、简单项目开发和发布的分支管理及流程</h3><p>1、使用主题分支 ruby_client 进行开发</p>
<p><img src="https://pic2.zhimg.com/80/v2-55fb6b3597df1353a4772a531b71a905_720w.webp" alt="img"></p>
<p>2、开发完成后将主题分支合并到 develop 分支提测和回归</p>
<p><img src="https://pic2.zhimg.com/80/v2-e8ec381fade7869b2a5984ee734bf905_720w.webp" alt="img"></p>
<p>3、使用 develop 分支发布，发布完成版本稳定后，将 master 分支 fast-forward 到develop 最新 commit。此时可以在master 分支上拉出新的分支进行新的迭代</p>
<p><img src="https://pic4.zhimg.com/80/v2-9d631a462b8eb5a791820f779295592b_720w.webp" alt="img"></p>
<h2 id="参照文档："><a href="#参照文档：" class="headerlink" title="参照文档："></a>参照文档：</h2><p><a href="https://link.zhihu.com/?target=https://git-scm.com/docs">Git - Reference</a><a href="https://link.zhihu.com/?target=https://git-scm.com/book/zh/v2">Git - Book</a><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/96631135">腾讯技术工程：这才是真正的Git——Git内部原理揭秘！</a><a href="https://link.zhihu.com/?target=https://marklodato.github.io/visual-git-guide/index-zh-cn.html%23rebase">图解Git</a></p>

        
  </div>
</article>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023
    csbrdw
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/tags/">标签</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/cyx27">项目</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
